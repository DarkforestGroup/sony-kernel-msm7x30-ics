--- drivers/usb/core/hub.c
+++ drivers/usb/core/hub.c
@@ -22,7 +22,6 @@
 #include <linux/kthread.h>
 #include <linux/mutex.h>
 #include <linux/freezer.h>
-#include <linux/usb/quirks.h>
 
 #include <asm/uaccess.h>
 #include <asm/byteorder.h>
@@ -1754,18 +1719,12 @@
 {
 	int err;
 
-	if (udev->parent) {
-		/* Increment the parent's count of unsuspended children */
+	/* Increment the parent's count of unsuspended children */
+	if (udev->parent)
 		usb_autoresume_device(udev->parent);
 
-		/* Initialize non-root-hub device wakeup to disabled;
-		 * device (un)configuration controls wakeup capable
-		 * sysfs power/wakeup controls wakeup enabled/disabled
-		 */
-		device_init_wakeup(&udev->dev, 0);
-	}
-
-	err = usb_enumerate_device(udev);	/* Read descriptors */
+	usb_detect_quirks(udev);		/* Determine quirks */
+	err = usb_configure_device(udev);	/* detect & probe dev/intfs */
 	if (err < 0)
 		goto fail;
 	dev_dbg(&udev->dev, "udev %d, busnum %d, minor = %d\n",
